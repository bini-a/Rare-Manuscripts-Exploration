import streamlit as st
import pandas as pd
import numpy as np



def app():
    @st.cache
    # Load data
    def load_data():
        df = pd.read_csv("main_file_dataset.csv")
        return df
    df = load_data()
    # st.dataframe(df)
                  
     # Dictionaries with indices for history searching
    president_indices = {"York": [7072, 14590, 50164, 50170], "Craven": [2004, 2005, 9541, 10235, 11146, 11155, 11156, 11161, 11167, 11168, 11169, 11170, 11171, 11172, 11173, 11174, 11175, 11176, 11177, 11178, 11179, 11180, 11181, 11182, 11183, 11197, 11200, 14590, 15131, 19231, 20678, 20732, 21211, 25196, 27216, 48485], 
              "Gannaway": [6266, 6267, 6269, 16522, 41864], "Wood": [13320, 30929, 30984, 49501, 49528], 
              "Crowell": [127, 11387, 19234, 32886, 46573], "Kilgo": [158, 6815, 21326, 25715, 31143, 31930, 42066, 42069, 45697, 45808], 
              "Few": [4293, 4295, 5490, 5535, 6660, 7338, 7356, 13399, 13678, 13680, 14742, 15288, 15290, 15291, 15292, 15293, 15294, 15726, 17493, 17627, 17628, 17632, 18218, 21323, 26808, 28326, 32409, 34437, 34637, 35247, 42069, 46891, 47138, 47141], 
              "Flowers": [10743, 15710, 16296, 19004, 20519, 22959, 26399, 27309, 28173, 30657, 34052, 42059, 42065, 44500, 45697], 
            "Edens": [], "Hart": [14123], "Knight": [5490, 25741, 30171, 47829],
              "Sanford": [5490, 9533, 9541, 9554, 19873, 19875, 22266, 39311, 39312, 39313, 39314, 39363, 39364, 39365, 42007, 44948, 45317], 
              "Brodie": [], "Keohane": [], "Brodhead": [2619, 34442, 35593]}
    name_indices = {'brown': [], 'union': [31358, 50170], 'normal': [410, 2004, 4821, 5148, 5149, 6904, 7031, 9828, 15130, 15131, 15133, 20074, 20075, 25093, 25094, 25195, 44683, 47523, 47901, 48481, 48488], 'trinity': [127, 158, 932, 949, 1950, 2004, 2726, 4207, 4294, 4855, 4859, 5861, 5864, 5955, 6085, 6659, 6815, 6917, 6918, 6921, 7684, 7685, 7687, 7688, 7698, 7700, 8356, 9180, 9645, 10235, 10741, 10906, 10920, 11155, 11156, 11158, 11161, 11164, 11197, 11199, 11200, 11731, 11822, 12078, 13261, 13302, 13303, 13317, 13671, 13674, 14005, 15133, 16211, 17237, 17238, 17239, 17306, 17967, 19231, 19295, 19298, 19384, 20729, 20731, 21237, 21765, 22038, 22129, 22147, 22150, 22158, 23045, 24107, 24513, 24523, 24837, 25004, 25621, 25748, 27216, 27397, 27816, 27836, 28173, 28657, 28659, 28828, 30321, 30375, 30376, 30480, 30706, 30943, 30945, 30947, 30951, 31012, 31013, 31015, 31016, 31017, 31018, 31019, 31247, 31977, 32804, 32886, 34437, 34637, 34654, 35029, 35460, 37321, 37405, 37500, 37748, 37801, 38323, 38324, 39272, 39480, 39481, 39702, 40312, 40454, 40468, 40616, 40644, 40703, 41457, 41590, 41594, 41642, 41914, 42030, 42061, 42065, 42066, 42069, 42408, 42531, 42532, 42919, 42927, 43242, 43348, 43352, 43354, 43616, 43619, 44460, 44474, 44507, 44696, 45276, 45662, 45663, 45693, 45696, 45697, 45808, 46887, 47503, 47523, 49746, 49750, 49751, 50170, 50219], 'duke': [59, 60, 258, 415, 509, 515, 568, 570, 571, 572, 575, 577, 596, 749, 751, 752, 800, 878, 881, 888, 1084, 1085, 1408, 1432, 1594, 1619, 1941, 1950, 2095, 2168, 2178, 2388, 2820, 2829, 3592, 3885, 3912, 4139, 4143, 4273, 4294, 4463, 4465, 4466, 4467, 4471, 4472, 4504, 4664, 4665, 4860, 5148, 5149, 5231, 5488, 5489, 5610, 5730, 6085, 6086, 6090, 6106, 6116, 6122, 6185, 6186, 6236, 6265, 6434, 6551, 6565, 6630, 6773, 6777, 6844, 6986, 6990, 7021, 7337, 7484, 7683, 7688, 7701, 7974, 8023, 8085, 8090, 8093, 8185, 8191, 8251, 8356, 9038, 9179, 9180, 9260, 9273, 9404, 9405, 9407, 9410, 9412, 9414, 9417, 9419, 9420, 9645, 9663, 10329, 10354, 10386, 10504, 10662, 10743, 10752, 10753, 11037, 11045, 11168, 11175, 11197, 11337, 11735, 11737, 11823, 12145, 12152, 12533, 12561, 12679, 13053, 13141, 13302, 13318, 13655, 13669, 13692, 13693, 13694, 13695, 13696, 13741, 13743, 13745, 13746, 13747, 13750, 13751, 13752, 13753, 13754, 13755, 13756, 13757, 13758, 13759, 13760, 13761, 13762, 13763, 13764, 13765, 13766, 13767, 13768, 13769, 13770, 13771, 13772, 13773, 13774, 13775, 13776, 13777, 13778, 13779, 13780, 13781, 13782, 13783, 13793, 13795, 13796, 13797, 13798, 13799, 13800, 13801, 13806, 13807, 13808, 13809, 14399, 14484, 14512, 14516, 14517, 14585, 14623, 14861, 14979, 14983, 15294, 15511, 15697, 15751, 15752, 15927, 15939, 16184, 16278, 16529, 16542, 16556, 16557, 16797, 16842, 16922, 17179, 17472, 17493, 17494, 17497, 17498, 17754, 17756, 18432, 18666, 18712, 18713, 18952, 19185, 19309, 19311, 19334, 19384, 19444, 19616, 19647, 19648, 19650, 19651, 19652, 19653, 19658, 19660, 19662, 19666, 19771, 19865, 19909, 19912, 19920, 20156, 20210, 20212, 20214, 20318, 20523, 20542, 20549, 20823, 21005, 21396, 21508, 21566, 21616, 21723, 21815, 21954, 22050, 22265, 22266, 22267, 22272, 22285, 22594, 22595, 22597, 22618, 22772, 22868, 22869, 22871, 22893, 22895, 22905, 22921, 22922, 22923, 22926, 22943, 23288, 23343, 23775, 23909, 24166, 24237, 24525, 24619, 24838, 25049, 25074, 25251, 25262, 25263, 25264, 25665, 26306, 26307, 26393, 26398, 26399, 26603, 26801, 26854, 27338, 27340, 27457, 27486, 27719, 27720, 27790, 27802, 27889, 28247, 28561, 28601, 28658, 28718, 28828, 29203, 29456, 29573, 29623, 30375, 30376, 30650, 30666, 30677, 31230, 31322, 31509, 31813, 31892, 31899, 32183, 32297, 32343, 32851, 32877, 32971, 33042, 33092, 33642, 33672, 33917, 33922, 34078, 34080, 34136, 34437, 34537, 34539, 34654, 34850, 34882, 35029, 35030, 35031, 35234, 35237, 35251, 35367, 35373, 35418, 35620, 35990, 36033, 36215, 36299, 36493, 36495, 36496, 36542, 36652, 36711, 36804, 36868, 36869, 37052, 37205, 37214, 37221, 37260, 37261, 37263, 37405, 37612, 37613, 37656, 37657, 37801, 37847, 37849, 38056, 38063, 38064, 38071, 38235, 38401, 38412, 38679, 38866, 39017, 39135, 39255, 39258, 39271, 39294, 39295, 39297, 39311, 39313, 39314, 39673, 39675, 39679, 39680, 39681, 39744, 39745, 39747, 39748, 40073, 40076, 40077, 40078, 40080, 40082, 40083, 40235, 40319, 40337, 40338, 40616, 40703, 40878, 40952, 40978, 41173, 41174, 41568, 41644, 41703, 41736, 41775, 42007, 42051, 42069, 42377, 42533, 42780, 42991, 42994, 43032, 43238, 43242, 43243, 43244, 43247, 43338, 43348, 43352, 43369, 43370, 43417, 43598, 43599, 43616, 43760, 43762, 43763, 43996, 44012, 44200, 44245, 44447, 44459, 44513, 44535, 44812, 44857, 44859, 45317, 45318, 45704, 45710, 45866, 46093, 46469, 46470, 46473, 46685, 47102, 47152, 47173, 47272, 47601, 47703, 47864, 47880, 47979, 48169, 48439, 48644, 48709, 49487, 49585, 49586, 49592, 49716, 50170]}
    buildings = {'Alspaugh': [644], 'Baldwin': [2093, 2094, 20279, 21958, 21987, 21988, 33105, 33124, 33125], 'Bassett': [2902, 2903], 'Blackwell': [4524, 4525, 4529, 4530, 4532, 4534, 4537, 4549, 4550, 4551, 4552, 4553, 4554, 4555, 4556, 4557, 4558, 4559, 4560, 4561, 4562, 4563, 4564, 4565, 4566, 4567, 4568, 4569, 4570, 4571, 4572, 4573, 4574, 4575, 4577, 4578], 'Brodie': [5869], 'Brown': [672, 5635, 6019, 6023, 6045, 6046, 6047, 6049, 6059, 6060, 6062, 6065, 6068, 6069, 6073, 6076, 6077, 6079, 6081, 6082, 6083, 6084, 6123, 6125, 6127, 6134, 6136, 6137, 6138, 6140, 6142, 6145, 6146, 6148, 6150, 6153, 6156, 6157, 6158, 6159, 6160, 6161, 6163, 6164, 6165, 6166, 6167, 6168, 6169, 6170, 6171, 6172, 6173, 6174, 6175, 6176, 6184, 6188, 6192, 6195, 6196, 6198, 6201, 6202, 6206, 6215, 6223, 6224, 6225, 6226, 6240, 6241, 9600, 9605], 'Crowell': [11387], 'Giles': [17234, 17236, 17242, 17243, 43415, 43419, 47180], 'Lilly': [10994, 27597], 'Biddle': [4287, 4291, 4292, 4293, 4296, 4299, 4300, 4314, 4315, 4316, 4317, 4318, 4319, 4320, 4321, 4323, 4324, 38118, 40075], 'Pegram': [35032, 35033, 35034, 35035, 35036], 'Southgate': [42029, 42030, 42067, 42068], 'White': [27817, 48046, 48048, 48050, 48051, 48053, 48054, 48056, 48058, 48059, 48060, 48061, 48062, 48063, 48064, 48065, 48067, 48077, 48086, 48090, 48091, 48092, 48094, 48100, 48101, 48110, 48112, 48114, 48118, 48119, 48120, 48122, 48125, 48126, 48129, 48131, 48133, 48134, 48141, 48143, 48144, 48146], 'Wilson': [7645, 15252, 27146, 33430, 35342, 48955, 48958, 48960, 48961, 48964, 48967, 48968, 48969, 48970, 48971, 48980, 48986, 48987, 48990, 48996, 48998, 49000, 49004, 49007, 49008, 49009, 49019, 49021, 49024, 49028, 49030, 49031, 49034, 49035, 49036, 49038, 49040, 49042, 49043, 49045, 49047, 49049, 49052, 49053, 49056, 49059, 49062, 49064, 49066], 'Allen': [486, 487, 499, 503, 505, 507, 508, 509, 515, 518, 519, 520, 521, 522, 523, 524, 525, 529, 530, 533, 535, 538, 540, 544, 547, 548, 549, 550, 552, 553, 554, 563, 566, 14979, 15511, 17472, 22453, 34964, 35032, 35033, 35034, 35035, 35292, 35293, 37048, 49468], 'Flowers': [15700, 15708, 15710, 15711], 'Gray': [18368, 18369, 18370, 18372, 18375, 18381, 18383, 18386, 18388, 18390, 18391, 18392, 23022], 'Hart': [20569, 20574, 20575, 20577, 20579, 20580, 20582, 20584, 20588, 20593], 'Perkins': [35223, 35226, 35228, 35241, 35243, 35246], 'Rubenstein': [], 'Sanford': [37109, 39311, 39349, 39350, 39355, 39357, 39359, 39360, 39363, 39367], 'Wilkinson': [48566, 48572, 48574, 48575, 48577], 'Craven': [11142, 11146, 11147, 11153, 11154, 11167, 11184, 11192, 11193, 14234], 'Edens': [14394], 'Few': [15285, 15288, 15290, 15293], 'Kilgo': [25715]}
    charleston = [ 1295, 11346, 12237, 12465, 12498, 12499, 12820, 16096, 21313,
            24542, 35513, 36175, 37469]
    wil = [9038, 9039, 9040, 9041, 9044, 11353, 11354]
    civil_war = [14, 15, 113, 181, 200, 285, 287, 297, 351, 354, 376, 488, 537, 651, 675, 840, 841, 847, 862, 927, 941, 959, 961, 971, 972, 977, 995, 1015, 1029, 1033, 1079, 1103, 1294, 1380, 1412, 1413, 1420, 1426, 1453, 1454, 1456, 1462, 1464, 1483, 1487, 1499, 1524, 1536, 1537, 1554, 1561, 1568, 1728, 1753, 1786, 1795, 1796, 1800, 1813, 1855, 1857, 1901, 1926, 1928, 1930, 1931, 2021, 2027, 2318, 2438, 2440, 2441, 2527, 2564, 2583, 2629, 2745, 2750, 2770, 2794, 2797, 2828, 2830, 2834, 2857, 2858, 2875, 2876, 2879, 2895, 2925, 2931, 2932, 2975, 3001, 3007, 3020, 3025, 3032, 3048, 3085, 3086, 3088, 3092, 3097, 3115, 3117, 3123, 3179, 3205, 3211, 3225, 3241, 3265, 3270, 3359, 3371, 3379, 3382, 3384, 3394, 3419, 3421, 3441, 3463, 3475, 3536, 3537, 3572, 3697, 3699, 3711, 3714, 3728, 3731, 3766, 3767, 3792, 3810, 3816, 3817, 3824, 3859, 3884, 3890, 3899, 3902, 3903, 3940, 3949, 3954, 4051, 4096, 4098, 4099, 4103, 4104, 4130, 4159, 4187, 4310, 4311, 4339, 4340, 4378, 4409, 4413, 4520, 4521, 4541, 4666, 4695, 4698, 4705, 4721, 4775, 4777, 4849, 4865, 4880, 4881, 4948, 4976, 4987, 5005, 5055, 5062, 5063, 5078, 5110, 5150, 5174, 5190, 5207, 5209, 5230, 5304, 5389, 5401, 5404, 5410, 5438, 5441, 5455, 5462, 5465, 5468, 5488, 5490, 5495, 5497, 5504, 5513, 5519, 5548, 5569, 5585, 5600, 5607, 5634, 5695, 5718, 5737, 5751, 5753, 5754, 5791, 5847, 5850, 5861, 5862, 5864, 5885, 5911, 5934, 5939, 5945, 5966, 6029, 6059, 6068, 6130, 6189, 6191, 6195, 6225, 6250, 6251, 6252, 6256, 6259, 6268, 6277, 6323, 6332, 6350, 6351, 6352, 6362, 6365, 6385, 6387, 6509, 6584, 6592, 6607, 6638, 6639, 6649, 6752, 6759, 6774, 6823, 6866, 6872, 6967, 6972, 7028, 7034, 7055, 7056, 7071, 7074, 7139, 7155, 7157, 7197, 7205, 7206, 7211, 7220, 7340, 7366, 7393, 7395, 7416, 7419, 7501, 7507, 7508, 7509, 7532, 7537, 7538, 7540, 7556, 7617, 7647, 7681, 7697, 7699, 7703, 7719, 7721, 7735, 7766, 7779, 7804, 7805, 7870, 7877, 7964, 8001, 8003, 8005, 8014, 8032, 8100, 8102, 8126, 8135, 8160, 8163, 8191, 8192, 8228, 8229, 8293, 8295, 8448, 8453, 8504, 8572, 8596, 8608, 8639, 8642, 8684, 8685, 8686, 8687, 8688, 8689, 8711, 8725, 8856, 8857, 8870, 8919, 8941, 8994, 9007, 9008, 9057, 9059, 9170, 9221, 9238, 9248, 9250, 9259, 9260, 9265, 9277, 9321, 9326, 9375, 9383, 9384, 9386, 9506, 9545, 9564, 9567, 9568, 9569, 9577, 9578, 9579, 9580, 9635, 9699, 9713, 9820, 9825, 9827, 9829, 10007, 10035, 10073, 10185, 10208, 10209, 10245, 10263, 10264, 10265, 10266, 10267, 10270, 10495, 10498, 10499, 10585, 10586, 10646, 10653, 10669, 10679, 10680, 10695, 10697, 10707, 10708, 10709, 10714, 10728, 10732, 10734, 10760, 10789, 10795, 10796, 10797, 10814, 10823, 10826, 10837, 10889, 10897, 10900, 10903, 10920, 10922, 10923, 10940, 10950, 11008, 11058, 11078, 11079, 11082, 11120, 11121, 11122, 11194, 11223, 11234, 11294, 11299, 11306, 11344, 11345, 11348, 11350, 11372, 11373, 11400, 11418, 11442, 11469, 11525, 11531, 11543, 11576, 11606, 11609, 11677, 11678, 11685, 11700, 11715, 11718, 11728, 11745, 11754, 11755, 11765, 11767, 11768, 11787, 11794, 11796, 11803, 11918, 11978, 11992, 12013, 12014, 12017, 12024, 12044, 12045, 12057, 12069, 12097, 12101, 12106, 12139, 12165, 12167, 12168, 12187, 12225, 12302, 12450, 12475, 12502, 12602, 12603, 12604, 12619, 12629, 12654, 12699, 12706, 12708, 12712, 12749, 12750, 12763, 12766, 12806, 12808, 12817, 12867, 12868, 12882, 12909, 12945, 12974, 12977, 13019, 13020, 13043, 13057, 13083, 13087, 13094, 13117, 13143, 13191, 13210, 13211, 13216, 13277, 13287, 13289, 13292, 13294, 13303, 13304, 13314, 13333, 13357, 13391, 13402, 13422, 13426, 13429, 13495, 13529, 13530, 13550, 13584, 13716, 13722, 13812, 13956, 13959, 13965, 13988, 13991, 14188, 14199, 14212, 14222, 14270, 14382, 14433, 14483, 14493, 14508, 14509, 14528, 14539, 14541, 14561, 14564, 14589, 14591, 14606, 14611, 14615, 14618, 14630, 14638, 14649, 14663, 14664, 14665, 14666, 14728, 14729, 14739, 14766, 14767, 14806, 14856, 14963, 14969, 14970, 14974, 14976, 14982, 15075, 15078, 15082, 15110, 15120, 15122, 15189, 15222, 15241, 15301, 15317, 15429, 15435, 15445, 15479, 15480, 15516, 15518, 15536, 15537, 15544, 15547, 15551, 15622, 15658, 15670, 15675, 15678, 15739, 15740, 15742, 15743, 15783, 15809, 15812, 15816, 15820, 15821, 15822, 15840, 15855, 15864, 15894, 15895, 15898, 15900, 15911, 15925, 15926, 15943, 16000, 16010, 16067, 16092, 16093, 16138, 16140, 16228, 16229, 16242, 16289, 16297, 16307, 16308, 16309, 16314, 16321, 16325, 16342, 16383, 16385, 16388, 16457, 16475, 16476, 16477, 16482, 16516, 16517, 16538, 16565, 16569, 16574, 16600, 16606, 16607, 16626, 16627, 16652, 16691, 16718, 16750, 16754, 16799, 16807, 16808, 16809, 16810, 16818, 16819, 16823, 16824, 16845, 16856, 16865, 17043, 17081, 17148, 17149, 17260, 17292, 17401, 17403, 17437, 17566, 17613, 17618, 17628, 17666, 17671, 17673, 17742, 17884, 17886, 17892, 17896, 17904, 17906, 17908, 17924, 17931, 17935, 17937, 17942, 17943, 17944, 17945, 17948, 17953, 17955, 18055, 18056, 18147, 18151, 18154, 18199, 18215, 18217, 18218, 18222, 18384, 18570, 18672, 18677, 18689, 18705, 18964, 18971, 18972, 19027, 19029, 19168, 19169, 19190, 19191, 19244, 19248, 19264, 19266, 19271, 19284, 19286, 19302, 19318, 19345, 19365, 19394, 19395, 19405, 19408, 19447, 19448, 19512, 19527, 19587, 19615, 19637, 19710, 19715, 19739, 19798, 19840, 19844, 19936, 19947, 19967, 19974, 19991, 20006, 20022, 20026, 20079, 20097, 20188, 20218, 20223, 20281, 20282, 20290, 20320, 20354, 20366, 20371, 20430, 20453, 20479, 20500, 20504, 20561, 20571, 20597, 20600, 20614, 20662, 20665, 20671, 20732, 20735, 20736, 20737, 20779, 20800, 20803, 20869, 20975, 20985, 21000, 21031, 21046, 21050, 21170, 21246, 21250, 21251, 21302, 21306, 21393, 21415, 21416, 21420, 21472, 21494, 21558, 21561, 21592, 21594, 21597, 21744, 21782, 21823, 21865, 21866, 21895, 21898, 21899, 21908, 21995, 22067, 22134, 22136, 22158, 22202, 22257, 22258, 22273, 22326, 22420, 22421, 22428, 22430, 22443, 22487, 22488, 22493, 22605, 22630, 22651, 22669, 22671, 22691, 22778, 22785, 22795, 22796, 22827, 22835, 22840, 22845, 22856, 22857, 22866, 22949, 22957, 23093, 23112, 23176, 23243, 23248, 23274, 23280, 23439, 23494, 23560, 23601, 23605, 23813, 23893, 23894, 23930, 23967, 23969, 23986, 23992, 23996, 23997, 24092, 24120, 24132, 24163, 24166, 24170, 24320, 24342, 24350, 24361, 24373, 24392, 24453, 24454, 24470, 24546, 24599, 24640, 24717, 24718, 24743, 24819, 24820, 24821, 24823, 24829, 24870, 24873, 24905, 24925, 24930, 24981, 24982, 24995, 25002, 25003, 25017, 25097, 25098, 25126, 25163, 25210, 25230, 25277, 25287, 25308, 25336, 25338, 25339, 25360, 25362, 25363, 25376, 25378, 25379, 25393, 25394, 25395, 25396, 25435, 25438, 25441, 25448, 25454, 25477, 25501, 25505, 25519, 25542, 25561, 25569, 25609, 25620, 25636, 25669, 25670, 25673, 25712, 25727, 25728, 25806, 25812, 25876, 26186, 26191, 26201, 26213, 26220, 26244, 26270, 26272, 26426, 26497, 26586, 26588, 26639, 26677, 26678, 26686, 26737, 26738, 26749, 26822, 26833, 26871, 26885, 26887, 26913, 26977, 26978, 26979, 26980, 26993, 27001, 27019, 27046, 27058, 27125, 27245, 27246, 27247, 27260, 27262, 27365, 27367, 27392, 27427, 27523, 27537, 27562, 27587, 27660, 27661, 27678, 27763, 27789, 27790, 27816, 27834, 27888, 27895, 27956, 28004, 28007, 28011, 28017, 28021, 28053, 28076, 28083, 28086, 28088, 28105, 28116, 28117, 28120, 28129, 28130, 28150, 28226, 28240, 28241, 28305, 28343, 28368, 28390, 28418, 28440, 28485, 28489, 28494, 28509, 28559, 28575, 28576, 28582, 28583, 28592, 28594, 28645, 28657, 28659, 28666, 28668, 28669, 28694, 28759, 28779, 28810, 28817, 28832, 28862, 28908, 28920, 28930, 28942, 28955, 28967, 29009, 29015, 29018, 29031, 29045, 29050, 29084, 29096, 29111, 29112, 29145, 29151, 29162, 29222, 29223, 29225, 29241, 29274, 29329, 29400, 29439, 29446, 29466, 29542, 29601, 29602, 29608, 29613, 29643, 29693, 29782, 29799, 29812, 29818, 29821, 29825, 29827, 29838, 29964, 29982, 30020, 30084, 30196, 30197, 30198, 30199, 30217, 30266, 30290, 30292, 30295, 30360, 30361, 30391, 30398, 30505, 30628, 31197, 31198, 31203, 31253, 31255, 31310, 31312, 31345, 31403, 31417, 31421, 31474, 31539, 31556, 31562, 31566, 31570, 31588, 31597, 31598, 31603, 31613, 31658, 31659, 31686, 31702, 31703, 31708, 31733, 31806, 31807, 31838, 31844, 32072, 32090, 32158, 32187, 32189, 32190, 32204, 32212, 32216, 32247, 32250, 32260, 32285, 32310, 32323, 32326, 32353, 32400, 32404, 32406, 32407, 32408, 32409, 32418, 32419, 32425, 32429, 32433, 32434, 32494, 32504, 32505, 32508, 32512, 32515, 32517, 32525, 32562, 32564, 32569, 32573, 32588, 32607, 32615, 32616, 32637, 32661, 32678, 32686, 32690, 32737, 32738, 32748, 32857, 32862, 32883, 32890, 32894, 32897, 32901, 32927, 32992, 32996, 32997, 33007, 33011, 33013, 33034, 33068, 33106, 33109, 33147, 33171, 33230, 33237, 33270, 33273, 33460, 33461, 33492, 33500, 33508, 33516, 33533, 33541, 33549, 33556, 33557, 33619, 33683, 33758, 33760, 33764, 33774, 33784, 33789, 33801, 33868, 33877, 33886, 33895, 33897, 33931, 33934, 33995, 34175, 34192, 34263, 34306, 34311, 34313, 34372, 34398, 34444, 34493, 34497, 34509, 34514, 34531, 34543, 34578, 34593, 34637, 34648, 34652, 34653, 34656, 34657, 34683, 34694, 34724, 34781, 34787, 34789, 34809, 34813, 34819, 34837, 34851, 34852, 34855, 34858, 34965, 34980, 35036, 35046, 35069, 35074, 35075, 35086, 35089, 35115, 35117, 35133, 35144, 35145, 35169, 35176, 35306, 35324, 35348, 35420, 35450, 35505, 35508, 35529, 35542, 35554, 35592, 35601, 35630, 35631, 35661, 35670, 35671, 35672, 35676, 35678, 35694, 35739, 35743, 35773, 35799, 35822, 35832, 35842, 36005, 36076, 36090, 36091, 36128, 36141, 36143, 36144, 36145, 36146, 36147, 36148, 36179, 36180, 36254, 36278, 36310, 36344, 36346, 36389, 36396, 36401, 36603, 36646, 36647, 36659, 36850, 36925, 36997, 37004, 37035, 37044, 37045, 37060, 37101, 37103, 37134, 37163, 37218, 37219, 37220, 37336, 37346, 37348, 37385, 37417, 37438, 37475, 37513, 37530, 37532, 37589, 37590, 37617, 37647, 37680, 37682, 37706, 37728, 37742, 37745, 37771, 37773, 37788, 37937, 37952, 37955, 37971, 37996, 38007, 38010, 38109, 38152, 38154, 38206, 38239, 38241, 38252, 38253, 38267, 38285, 38291, 38309, 38336, 38348, 38370, 38378, 38434, 38438, 38476, 38477, 38488, 38531, 38536, 38538, 38564, 38631, 38692, 38745, 38749, 38758, 38788, 38790, 38797, 38799, 38803, 38902, 38903, 38909, 38911, 38987, 38988, 38990, 39002, 39014, 39038, 39069, 39082, 39183, 39205, 39206, 39236, 39304, 39357, 39358, 39394, 39418, 39422, 39423, 39465, 39535, 39552, 39565, 39592, 39593, 39609, 39648, 39650, 39670, 39706, 39720, 39723, 39740, 39752, 39772, 39806, 39818, 39901, 39978, 40050, 40058, 40100, 40101, 40128, 40129, 40131, 40136, 40138, 40197, 40202, 40208, 40215, 40237, 40238, 40255, 40305, 40333, 40387, 40403, 40414, 40420, 40424, 40428, 40429, 40433, 40450, 40461, 40492, 40493, 40495, 40501, 40502, 40503, 40505, 40541, 40589, 40590, 40662, 40667, 40781, 40787, 40796, 40843, 40844, 40847, 40851, 40897, 40917, 40921, 40958, 40994, 40996, 40999, 41056, 41075, 41078, 41088, 41108, 41127, 41146, 41171, 41187, 41195, 41198, 41212, 41226, 41228, 41235, 41239, 41240, 41302, 41306, 41307, 41309, 41384, 41386, 41397, 41399, 41403, 41405, 41414, 41492, 41494, 41500, 41502, 41519, 41523, 41528, 41551, 41554, 41641, 41761, 41765, 41802, 41857, 41858, 41859, 41868, 41880, 41892, 41995, 42045, 42055, 42057, 42071, 42077, 42078, 42080, 42115, 42163, 42170, 42172, 42189, 42193, 42211, 42276, 42286, 42295, 42350, 42368, 42380, 42385, 42414, 42464, 42465, 42494, 42502, 42503, 42511, 42596, 42597, 42598, 42617, 42618, 42620, 42622, 42627, 42629, 42821, 42829, 42831, 42841, 42842, 42854, 42875, 42968, 42982, 43033, 43034, 43037, 43038, 43040, 43043, 43052, 43092, 43098, 43129, 43143, 43165, 43276, 43278, 43360, 43364, 43399, 43463, 43486, 43499, 43501, 43515, 43517, 43519, 43546, 43553, 43558, 43562, 43596, 43605, 43617, 43636, 43637, 43642, 43658, 43678, 43719, 43749, 43754, 43796, 43811, 43849, 43852, 43869, 43880, 43888, 43906, 43911, 43923, 43930, 43942, 43958, 44017, 44020, 44023, 44037, 44056, 44057, 44059, 44101, 44162, 44177, 44180, 44181, 44204, 44219, 44223, 44226, 44231, 44232, 44249, 44326, 44328, 44350, 44376, 44394, 44407, 44423, 44435, 44517, 44622, 44654, 44687, 44696, 44697, 44722, 44750, 44921, 44923, 44927, 44938, 44989, 44991, 45018, 45045, 45065, 45232, 45244, 45324, 45342, 45343, 45347, 45350, 45362, 45397, 45398, 45399, 45414, 45578, 45650, 45652, 45700, 45702, 45765, 45766, 45767, 45785, 45817, 45837, 45840, 45841, 45904, 45933, 45934, 45949, 45950, 45954, 45955, 45961, 45962, 45989, 46048, 46049, 46052, 46061, 46072, 46360, 46403, 46408, 46431, 46432, 46433, 46436, 46481, 46512, 46514, 46634, 46639, 46648, 46669, 46679, 46693, 46694, 46705, 46715, 46737, 46835, 46878, 46899, 46939, 46962, 46966, 46969, 46985, 46988, 46990, 47015, 47023, 47024, 47043, 47057, 47060, 47078, 47134, 47176, 47200, 47215, 47217, 47218, 47219, 47226, 47286, 47289, 47292, 47293, 47310, 47341, 47392, 47393, 47443, 47497, 47501, 47599, 47604, 47606, 47650, 47662, 47663, 47680, 47737, 47756, 47758, 47824, 47840, 47841, 47888, 47889, 47890, 47898, 47900, 47944, 47953, 47954, 47970, 47977, 48011, 48012, 48013, 48024, 48027, 48032, 48033, 48048, 48126, 48135, 48145, 48156, 48157, 48166, 48185, 48193, 48196, 48223, 48229, 48239, 48310, 48314, 48318, 48319, 48398, 48402, 48409, 48493, 48494, 48501, 48510, 48517, 48521, 48522, 48525, 48528, 48538, 48539, 48541, 48558, 48563, 48599, 48607, 48621, 48624, 48626, 48628, 48631, 48693, 48765, 48824, 48829, 48891, 49032, 49045, 49046, 49070, 49071, 49127, 49154, 49160, 49163, 49206, 49286, 49327, 49334, 49362, 49364, 49365, 49407, 49532, 49534, 49566, 49567, 49583, 49607, 49609, 49625, 49629, 49638, 49639, 49643, 49652, 49659, 49666, 49715, 49716, 49723, 49742, 49761, 49785, 49791, 49806, 49810, 49811, 49812, 49813, 50010, 50014, 50029, 50060, 50085, 50110, 50127, 50138, 50139, 50148, 50159, 50223, 50295, 50330, 50342]
    slavery = [52, 53, 120, 121, 154, 166, 168, 170, 172, 230, 231, 232, 254, 290, 296, 343, 384, 398, 405, 425, 427, 429, 431, 433, 440, 447, 449, 500, 501, 502, 564, 580, 606, 676, 687, 696, 697, 698, 840, 853, 908, 921, 932, 933, 978, 979, 980, 981, 987, 1003, 1008, 1019, 1030, 1034, 1036, 1044, 1049, 1050, 1051, 1056, 1075, 1079, 1080, 1194, 1199, 1248, 1250, 1253, 1256, 1259, 1332, 1367, 1372, 1381, 1418, 1419, 1429, 1455, 1485, 1605, 1748, 1783, 1800, 1854, 1855, 1866, 1902, 2000, 2010, 2042, 2043, 2044, 2045, 2115, 2119, 2120, 2121, 2131, 2134, 2162, 2193, 2199, 2207, 2212, 2213, 2214, 2219, 2228, 2250, 2269, 2270, 2280, 2305, 2306, 2315, 2316, 2322, 2323, 2332, 2339, 2342, 2348, 2351, 2359, 2360, 2361, 2362, 2363, 2364, 2365, 2374, 2381, 2384, 2392, 2428, 2463, 2477, 2478, 2551, 2682, 2685, 2692, 2694, 2724, 2742, 2845, 2849, 2850, 2852, 2904, 2974, 2975, 2985, 2986, 2987, 2989, 2990, 2997, 2998, 3036, 3072, 3073, 3134, 3137, 3138, 3139, 3147, 3150, 3160, 3193, 3194, 3196, 3197, 3200, 3233, 3235, 3250, 3294, 3311, 3347, 3354, 3357, 3361, 3395, 3396, 3398, 3399, 3403, 3434, 3504, 3511, 3512, 3568, 3571, 3601, 3603, 3631, 3673, 3707, 3708, 3709, 3710, 3719, 3732, 3746, 3752, 3765, 3804, 3807, 3827, 3832, 3836, 3837, 3842, 3854, 4043, 4103, 4104, 4200, 4312, 4380, 4382, 4399, 4407, 4408, 4409, 4515, 4516, 4522, 4526, 4527, 4528, 4534, 4535, 4536, 4664, 4665, 4666, 4667, 4668, 4669, 4684, 4695, 4696, 4697, 4698, 4699, 4701, 4704, 4705, 4710, 4714, 4723, 4772, 4923, 4925, 4937, 4986, 4991, 4993, 5015, 5108, 5172, 5185, 5188, 5209, 5229, 5230, 5281, 5287, 5288, 5295, 5303, 5339, 5404, 5407, 5412, 5434, 5441, 5473, 5583, 5595, 5602, 5643, 5700, 5721, 5725, 5750, 5794, 5795, 5873, 5885, 5890, 5935, 5938, 5940, 5941, 5946, 5948, 5949, 5970, 5992, 6018, 6052, 6054, 6079, 6080, 6131, 6183, 6194, 6218, 6222, 6279, 6329, 6335, 6336, 6339, 6350, 6363, 6386, 6389, 6391, 6392, 6393, 6394, 6399, 6400, 6401, 6407, 6408, 6413, 6418, 6421, 6422, 6424, 6426, 6428, 6429, 6431, 6491, 6501, 6530, 6561, 6563, 6568, 6569, 6574, 6583, 6590, 6608, 6622, 6624, 6632, 6637, 6638, 6640, 6641, 6642, 6643, 6644, 6645, 6646, 6686, 6695, 6729, 6730, 6795, 6806, 6812, 6833, 6835, 6846, 6851, 6910, 6964, 6993, 7032, 7035, 7036, 7047, 7048, 7092, 7093, 7098, 7105, 7108, 7112, 7114, 7116, 7122, 7123, 7155, 7156, 7190, 7202, 7203, 7235, 7258, 7261, 7341, 7349, 7362, 7403, 7445, 7524, 7531, 7608, 7609, 7681, 7693, 7696, 7735, 7750, 7765, 7766, 7780, 7781, 7812, 7813, 7815, 7816, 7818, 7819, 7822, 7825, 7828, 7842, 7853, 8006, 8131, 8163, 8171, 8189, 8197, 8221, 8222, 8228, 8229, 8333, 8350, 8353, 8408, 8412, 8416, 8418, 8421, 8429, 8448, 8451, 8452, 8453, 8459, 8478, 8493, 8494, 8497, 8506, 8570, 8583, 8592, 8602, 8605, 8606, 8637, 8856, 8870, 8883, 8887, 8888, 8889, 8894, 8896, 8897, 8924, 8966, 9028, 9029, 9032, 9039, 9041, 9042, 9043, 9046, 9048, 9051, 9052, 9058, 9059, 9062, 9068, 9108, 9122, 9135, 9138, 9153, 9157, 9168, 9170, 9235, 9249, 9262, 9265, 9266, 9316, 9429, 9433, 9445, 9452, 9511, 9512, 9515, 9524, 9526, 9527, 9528, 9535, 9551, 9582, 9583, 9586, 9591, 9592, 9694, 9699, 9717, 9722, 9732, 9751, 9816, 9833, 9834, 9947, 9952, 10006, 10046, 10047, 10054, 10102, 10120, 10156, 10164, 10263, 10299, 10481, 10482, 10644, 10653, 10666, 10677, 10716, 10739, 10755, 10756, 10757, 10764, 10765, 10801, 10802, 10806, 10821, 10859, 10876, 10879, 10889, 10890, 10891, 10914, 10919, 10920, 10947, 10948, 10952, 10964, 10999, 11012, 11042, 11045, 11072, 11073, 11074, 11105, 11120, 11122, 11195, 11203, 11207, 11245, 11257, 11274, 11306, 11348, 11349, 11354, 11379, 11382, 11392, 11401, 11412, 11445, 11465, 11544, 11554, 11561, 11562, 11567, 11592, 11594, 11607, 11610, 11613, 11615, 11637, 11638, 11642, 11643, 11645, 11647, 11680, 11684, 11685, 11704, 11717, 11778, 11803, 11816, 11839, 11875, 11878, 11880, 11895, 11896, 11917, 11918, 11952, 11953, 11957, 11970, 12014, 12015, 12016, 12069, 12072, 12091, 12092, 12098, 12100, 12102, 12109, 12142, 12166, 12168, 12201, 12204, 12297, 12298, 12367, 12397, 12398, 12409, 12410, 12416, 12426, 12446, 12461, 12472, 12494, 12598, 12657, 12658, 12672, 12691, 12718, 12742, 12743, 12745, 12748, 12755, 12756, 12789, 12794, 12819, 12821, 12846, 12853, 12862, 12866, 12868, 12871, 12884, 12887, 12895, 12910, 12949, 12962, 12991, 12993, 12997, 13000, 13006, 13045, 13090, 13097, 13107, 13111, 13119, 13163, 13187, 13210, 13211, 13216, 13219, 13265, 13270, 13305, 13307, 13320, 13334, 13377, 13383, 13385, 13401, 13411, 13422, 13438, 13440, 13442, 13447, 13448, 13449, 13450, 13456, 13457, 13458, 13460, 13461, 13462, 13548, 13553, 13555, 13602, 13612, 13626, 13715, 13727, 13819, 13850, 13962, 13967, 13971, 13978, 14219, 14275, 14281, 14336, 14366, 14395, 14397, 14415, 14417, 14490, 14564, 14591, 14615, 14666, 14669, 14698, 14711, 14712, 14713, 14714, 14748, 14831, 14864, 14869, 14923, 14949, 14950, 14974, 15071, 15083, 15084, 15109, 15110, 15224, 15233, 15240, 15277, 15280, 15292, 15353, 15358, 15369, 15429, 15432, 15433, 15448, 15458, 15459, 15476, 15477, 15478, 15479, 15520, 15551, 15568, 15580, 15583, 15587, 15621, 15668, 15671, 15672, 15777, 15834, 15839, 15840, 15855, 15858, 15861, 15862, 15864, 15897, 15964, 15965, 15969, 15978, 15995, 16001, 16003, 16004, 16005, 16010, 16012, 16014, 16015, 16059, 16072, 16075, 16076, 16104, 16111, 16143, 16174, 16203, 16249, 16250, 16254, 16256, 16258, 16259, 16262, 16263, 16264, 16265, 16266, 16267, 16268, 16269, 16270, 16276, 16303, 16307, 16319, 16345, 16378, 16391, 16396, 16453, 16485, 16486, 16514, 16516, 16517, 16519, 16520, 16537, 16539, 16545, 16556, 16559, 16592, 16622, 16623, 16627, 16628, 16673, 16674, 16687, 16688, 16689, 16718, 16750, 16751, 16752, 16753, 16754, 16755, 16756, 16777, 16794, 16795, 16801, 16808, 16809, 16810, 16847, 16854, 16855, 16857, 16861, 16864, 16865, 16866, 16867, 16871, 16872, 16876, 16895, 16896, 16937, 16938, 16939, 16940, 16943, 17033, 17034, 17035, 17036, 17081, 17101, 17114, 17116, 17117, 17120, 17128, 17131, 17132, 17185, 17288, 17289, 17290, 17291, 17294, 17295, 17328, 17332, 17355, 17416, 17427, 17428, 17432, 17433, 17438, 17471, 17681, 17709, 17910, 17926, 17930, 17941, 17948, 17950, 18031, 18050, 18051, 18091, 18148, 18203, 18209, 18212, 18222, 18381, 18382, 18401, 18402, 18494, 18503, 18564, 18565, 18566, 18568, 18572, 18672, 18683, 18721, 18722, 18906, 18980, 18982, 18983, 18984, 19114, 19117, 19132, 19169, 19179, 19201, 19212, 19249, 19270, 19280, 19284, 19286, 19304, 19305, 19341, 19342, 19364, 19365, 19379, 19380, 19490, 19516, 19528, 19547, 19548, 19549, 19594, 19628, 19636, 19637, 19639, 19640, 19704, 19707, 19709, 19711, 19713, 19714, 19737, 19770, 19771, 19778, 19779, 19788, 19798, 19814, 19828, 19886, 19891, 19902, 19903, 19904, 19905, 19931, 19941, 19967, 19984, 19991, 19996, 19999, 20011, 20016, 20020, 20058, 20074, 20076, 20134, 20135, 20171, 20196, 20221, 20253, 20254, 20255, 20281, 20282, 20285, 20286, 20290, 20303, 20317, 20324, 20326, 20329, 20341, 20343, 20344, 20345, 20368, 20380, 20383, 20385, 20386, 20388, 20389, 20393, 20396, 20409, 20412, 20414, 20466, 20467, 20560, 20561, 20615, 20617, 20653, 20723, 20789, 20811, 20812, 20814, 20848, 20857, 20869, 20888, 20964, 21000, 21002, 21011, 21045, 21054, 21056, 21061, 21067, 21071, 21072, 21074, 21075, 21076, 21077, 21080, 21085, 21086, 21087, 21088, 21091, 21092, 21095, 21098, 21099, 21100, 21102, 21104, 21105, 21106, 21109, 21111, 21114, 21120, 21122, 21124, 21126, 21134, 21135, 21136, 21137, 21138, 21139, 21140, 21142, 21145, 21147, 21148, 21149, 21150, 21152, 21153, 21162, 21165, 21166, 21168, 21174, 21175, 21176, 21177, 21179, 21180, 21181, 21183, 21184, 21185, 21186, 21187, 21188, 21189, 21190, 21191, 21193, 21194, 21199, 21200, 21201, 21207, 21213, 21215, 21216, 21218, 21223, 21226, 21233, 21239, 21250, 21295, 21302, 21303, 21304, 21306, 21313, 21314, 21440, 21441, 21442, 21443, 21537, 21554, 21555, 21597, 21612, 21639, 21644, 21752, 21753, 21767, 21801, 21807, 21810, 21812, 21862, 21887, 21898, 21939, 21963, 21997, 22006, 22007, 22057, 22086, 22090, 22108, 22110, 22160, 22177, 22180, 22199, 22203, 22204, 22206, 22213, 22218, 22219, 22220, 22223, 22248, 22260, 22423, 22424, 22449, 22508, 22513, 22525, 22529, 22538, 22611, 22625, 22655, 22742, 22743, 22744, 22754, 22755, 22785, 22786, 22801, 22802, 22803, 22804, 22821, 22957, 22989, 22990, 22991, 22993, 22997, 23127, 23128, 23129, 23131, 23133, 23165, 23166, 23183, 23184, 23186, 23188, 23189, 23219, 23352, 23354, 23400, 23415, 23504, 23536, 23547, 23571, 23603, 23797, 23814, 23915, 23930, 23931, 23963, 23976, 23977, 23978, 23982, 23988, 24020, 24021, 24048, 24067, 24088, 24089, 24144, 24161, 24166, 24266, 24277, 24293, 24322, 24337, 24349, 24366, 24372, 24454, 24468, 24495, 24497, 24503, 24536, 24546, 24596, 24600, 24607, 24629, 24669, 24670, 24680, 24719, 24720, 24721, 24739, 24747, 24856, 24871, 24892, 24896, 24903, 24913, 24933, 24948, 24973, 24982, 24990, 25004, 25013, 25014, 25031, 25097, 25114, 25115, 25126, 25133, 25144, 25147, 25160, 25161, 25163, 25165, 25167, 25168, 25177, 25184, 25195, 25279, 25303, 25305, 25308, 25376, 25380, 25404, 25437, 25440, 25445, 25449, 25459, 25524, 25547, 25571, 25658, 25674, 25703, 25704, 25705, 25706, 25707, 25708, 25709, 25712, 25725, 25873, 25874, 25875, 25876, 25877, 25878, 26122, 26125, 26135, 26196, 26203, 26205, 26217, 26221, 26240, 26318, 26323, 26325, 26326, 26327, 26329, 26336, 26337, 26338, 26340, 26344, 26420, 26428, 26429, 26441, 26452, 26483, 26485, 26589, 26592, 26599, 26616, 26617, 26640, 26668, 26697, 26700, 26743, 26794, 26805, 26868, 26912, 26922, 26942, 26974, 26992, 27020, 27048, 27049, 27057, 27058, 27105, 27106, 27112, 27115, 27118, 27134, 27135, 27138, 27140, 27141, 27142, 27152, 27175, 27192, 27193, 27196, 27204, 27205, 27269, 27329, 27491, 27500, 27542, 27549, 27587, 27591, 27592, 27631, 27667, 27668, 27763, 27765, 27766, 27767, 27769, 27770, 27814, 27849, 27857, 27900, 27901, 27907, 27931, 27961, 27999, 28020, 28086, 28116, 28117, 28119, 28120, 28123, 28131, 28133, 28137, 28138, 28139, 28140, 28141, 28145, 28146, 28287, 28290, 28291, 28292, 28293, 28301, 28310, 28315, 28347, 28349, 28351, 28352, 28353, 28354, 28370, 28375, 28376, 28379, 28474, 28584, 28585, 28598, 28612, 28636, 28637, 28749, 28753, 28769, 28772, 28796, 28810, 28836, 28837, 28838, 28840, 28841, 28843, 28845, 28848, 28915, 28916, 28919, 28921, 28922, 28923, 28925, 28928, 28932, 28933, 28944, 28945, 28946, 29025, 29030, 29031, 29032, 29040, 29041, 29049, 29076, 29101, 29111, 29150, 29152, 29155, 29156, 29157, 29159, 29160, 29173, 29179, 29204, 29211, 29228, 29247, 29248, 29249, 29251, 29257, 29271, 29308, 29309, 29543, 29553, 29555, 29566, 29579, 29585, 29587, 29593, 29602, 29603, 29604, 29606, 29607, 29609, 29610, 29618, 29619, 29652, 29699, 29707, 29743, 29801, 29808, 29812, 29813, 29821, 29858, 29859, 29881, 29903, 29921, 29922, 29923, 29931, 29933, 29936, 29938, 29939, 29969, 30030, 30032, 30039, 30059, 30065, 30067, 30087, 30092, 30095, 30110, 30129, 30130, 30131, 30177, 30178, 30181, 30182, 30219, 30222, 30224, 30237, 30302, 30303, 30306, 30380, 30425, 30448, 30449, 30450, 30513, 30534, 30589, 30624, 30626, 30627, 30628, 30653, 30669, 31007, 31200, 31209, 31289, 31299, 31303, 31304, 31305, 31306, 31311, 31327, 31335, 31340, 31360, 31364, 31400, 31401, 31403, 31426, 31428, 31500, 31501, 31520, 31522, 31532, 31557, 31563, 31613, 31636, 31683, 31684, 31690, 31691, 31699, 31708, 31709, 31736, 31758, 31842, 31849, 31910, 31925, 31971, 32021, 32022, 32062, 32063, 32071, 32093, 32095, 32156, 32158, 32160, 32163, 32190, 32206, 32207, 32212, 32262, 32267, 32285, 32349, 32354, 32357, 32426, 32450, 32469, 32471, 32473, 32474, 32475, 32477, 32478, 32784, 32786, 32802, 32822, 32826, 32837, 32838, 32840, 32842, 32847, 32864, 32881, 32997, 32998, 33020, 33021, 33022, 33023, 33024, 33025, 33026, 33027, 33028, 33029, 33030, 33031, 33032, 33033, 33034, 33035, 33036, 33037, 33050, 33056, 33060, 33061, 33104, 33113, 33120, 33144, 33145, 33182, 33191, 33226, 33447, 33482, 33483, 33516, 33517, 33518, 33519, 33520, 33521, 33543, 33544, 33550, 33551, 33557, 33584, 33596, 33597, 33599, 33708, 33803, 33821, 33838, 33851, 33869, 33873, 33887, 33916, 33917, 33920, 33945, 33949, 33983, 34003, 34026, 34037, 34051, 34119, 34120, 34121, 34122, 34181, 34192, 34248, 34306, 34337, 34338, 34339, 34369, 34441, 34597, 34598, 34599, 34610, 34611, 34689, 34692, 34694, 34811, 34819, 34833, 34880, 34881, 34897, 34950, 34951, 34976, 35045, 35069, 35077, 35164, 35165, 35166, 35172, 35175, 35177, 35178, 35179, 35289, 35290, 35291, 35326, 35353, 35358, 35359, 35389, 35500, 35503, 35534, 35540, 35585, 35591, 35604, 35605, 35615, 35616, 35631, 35635, 35643, 35645, 35646, 35670, 35690, 35691, 35782, 35783, 35799, 35835, 35855, 35872, 35889, 35979, 36065, 36066, 36068, 36069, 36139, 36141, 36153, 36157, 36158, 36161, 36264, 36265, 36310, 36320, 36342, 36367, 36368, 36369, 36370, 36463, 36516, 36647, 36648, 36665, 36788, 36805, 36844, 36862, 36925, 36994, 37098, 37109, 37110, 37115, 37121, 37133, 37134, 37135, 37140, 37154, 37163, 37213, 37236, 37244, 37290, 37291, 37292, 37293, 37294, 37319, 37340, 37366, 37417, 37418, 37423, 37424, 37426, 37427, 37472, 37491, 37501, 37503, 37507, 37509, 37550, 37554, 37555, 37558, 37564, 37566, 37567, 37568, 37571, 37618, 37619, 37636, 37639, 37652, 37666, 37675, 37676, 37705, 37706, 37713, 37726, 37748, 37777, 37780, 37782, 37791, 37793, 37815, 37857, 38009, 38010, 38034, 38136, 38169, 38171, 38179, 38225, 38248, 38249, 38250, 38281, 38306, 38334, 38341, 38352, 38364, 38391, 38416, 38500, 38562, 38699, 38709, 38751, 38752, 38759, 38776, 38840, 38907, 38911, 38912, 38913, 38922, 38932, 38933, 38964, 38981, 38992, 39002, 39037, 39047, 39049, 39052, 39059, 39067, 39071, 39078, 39079, 39092, 39155, 39301, 39302, 39308, 39353, 39424, 39468, 39492, 39526, 39531, 39580, 39590, 39649, 39650, 39712, 39740, 39753, 39761, 39799, 39803, 39809, 39819, 39856, 39867, 39881, 39886, 39893, 39894, 39896, 39897, 39899, 39900, 39913, 39914, 39977, 39978, 39981, 40058, 40142, 40188, 40227, 40237, 40238, 40312, 40336, 40373, 40374, 40385, 40401, 40403, 40489, 40490, 40495, 40496, 40497, 40498, 40504, 40505, 40508, 40509, 40510, 40513, 40533, 40648, 40655, 40657, 40692, 40741, 40789, 40790, 40792, 40802, 40803, 40807, 40810, 40812, 40813, 40822, 40823, 40827, 40828, 40832, 40833, 40834, 40843, 40846, 40848, 40849, 40851, 40873, 40874, 40913, 40919, 40920, 40921, 40959, 40963, 40974, 40990, 40991, 41018, 41021, 41027, 41033, 41041, 41047, 41057, 41059, 41065, 41070, 41076, 41091, 41108, 41124, 41154, 41157, 41191, 41198, 41221, 41260, 41318, 41320, 41321, 41322, 41336, 41337, 41366, 41402, 41403, 41409, 41423, 41429, 41430, 41431, 41433, 41434, 41436, 41437, 41440, 41441, 41442, 41457, 41486, 41530, 41531, 41532, 41533, 41541, 41552, 41553, 41554, 41555, 41576, 41599, 41605, 41606, 41609, 41659, 41660, 41724, 41765, 41787, 41869, 41956, 42136, 42154, 42166, 42167, 42206, 42208, 42312, 42358, 42392, 42395, 42497, 42504, 42505, 42620, 42772, 42827, 42841, 42842, 42843, 42855, 42870, 42871, 42913, 42914, 42951, 42952, 42953, 42957, 42959, 42960, 42965, 42967, 42971, 42976, 42981, 43067, 43072, 43075, 43252, 43256, 43299, 43300, 43375, 43378, 43405, 43409, 43493, 43500, 43501, 43512, 43513, 43521, 43522, 43530, 43531, 43535, 43549, 43555, 43572, 43574, 43575, 43577, 43578, 43579, 43608, 43658, 43662, 43663, 43695, 43696, 43701, 43761, 43764, 43770, 43799, 43811, 43812, 43898, 43939, 43955, 43962, 43963, 44019, 44039, 44043, 44111, 44115, 44116, 44118, 44119, 44121, 44123, 44124, 44132, 44143, 44218, 44225, 44238, 44239, 44367, 44385, 44386, 44387, 44389, 44395, 44396, 44397, 44398, 44399, 44400, 44408, 44410, 44420, 44479, 44494, 44632, 44648, 44658, 44660, 44754, 44764, 44790, 44841, 44872, 44884, 44886, 44891, 44896, 44899, 44901, 44902, 44904, 44905, 44912, 44916, 44917, 44926, 44927, 44929, 44955, 44979, 45042, 45056, 45058, 45059, 45148, 45154, 45156, 45157, 45163, 45167, 45219, 45223, 45225, 45294, 45320, 45321, 45362, 45374, 45444, 45475, 45476, 45507, 45508, 45514, 45519, 45523, 45579, 45636, 45676, 45702, 45725, 45726, 45750, 45751, 45753, 45811, 45817, 45818, 45936, 45938, 45947, 45961, 46190, 46191, 46361, 46520, 46521, 46652, 46704, 46717, 46719, 46740, 46782, 46793, 46794, 46795, 46879, 46890, 46894, 46898, 46903, 46947, 46949, 46950, 46963, 46975, 46981, 46990, 47005, 47032, 47061, 47078, 47101, 47102, 47108, 47139, 47143, 47209, 47221, 47227, 47311, 47354, 47365, 47383, 47398, 47484, 47486, 47492, 47494, 47495, 47498, 47505, 47508, 47525, 47526, 47542, 47543, 47556, 47568, 47597, 47598, 47603, 47661, 47726, 47728, 47737, 47743, 47747, 47839, 47841, 47842, 47845, 47889, 47890, 47899, 47936, 47939, 47963, 47991, 47995, 47996, 48028, 48031, 48032, 48033, 48092, 48093, 48103, 48149, 48154, 48159, 48160, 48194, 48199, 48236, 48239, 48240, 48242, 48243, 48244, 48255, 48256, 48340, 48342, 48344, 48349, 48350, 48355, 48357, 48358, 48359, 48360, 48361, 48362, 48363, 48364, 48369, 48375, 48384, 48456, 48496, 48547, 48598, 48599, 48640, 48719, 48721, 48750, 48755, 48756, 48757, 48769, 48788, 48859, 49032, 49126, 49136, 49137, 49147, 49148, 49199, 49200, 49235, 49295, 49296, 49314, 49333, 49335, 49359, 49388, 49435, 49470, 49531, 49532, 49599, 49600, 49657, 49658, 49660, 49661, 49664, 49715, 49765, 49783, 50026, 50029, 50060, 50061, 50078, 50084, 50085, 50102, 50103, 50104, 50105, 50106, 50107, 50119, 50148, 50159, 50243, 50275, 50291, 50343, 50345, 50362]


    
    def get_df_key_index(key,dic):
        if key=="All":
            return df.iloc[sum(dic.values(), [])]
        ind = dic[key]
        return df.iloc[ind,:]

    def dataset_selector():
        dataset_container = st.sidebar.beta_expander("""Explore Collections Related to Duke's History & Notable Events""",True)
        choice = ["Duke University Presidents",
            "Duke University Early Names","Duke Buildings","Charleston Earthquake", "Wilmington Race Riot of 1898","Civil War","History of Slavery"]
        with dataset_container:
            check = st.radio("Explore",choice)
            if check ==choice[0]:
                duke_pres = st.selectbox("Select Duke University President ",np.append(np.array("All"),sorted(list(president_indices.keys()))))
                return duke_pres,0
            elif check == choice[1]:
                duke_uni = st.selectbox("Select Duke University's Early Names ",
                 np.append(np.array("All"),sorted(list(name_indices.keys()))))
                return duke_uni,1
            elif check==choice[2]:
                build = st.selectbox("Select Duke University's Building Name ",
                 np.append(np.array("All"),sorted(list(buildings.keys()))))
                return build,2

            elif check == choice[2]:
                return None,"Charleston"
            elif check == choice[3]:
                return None, "Wilmington"
            elif check == choice[4]:
                return None,"Civil War"
            return None,"Slavery"

                
         

    def generate_data(selected_identity,explore_topic):
        if(explore_topic==0):
            exp_df = get_df_key_index(selected_identity,president_indices)
        elif(explore_topic==1):
            exp_df = get_df_key_index(selected_identity,name_indices)
        elif (explore_topic==2):
            exp_df = get_df_key_index(selected_identity,buildings)
        elif explore_topic=="Charleston":
            return df.iloc[charleston,:]
        elif explore_topic=="Wilmington":
            return df.iloc[wil,:]
        elif explore_topic=="Civil War":
            return df.iloc[civil_war,:]
        elif explore_topic=="Slavery":
            return df.iloc[slavery,:]
        return exp_df
    def short_link(df):
        def make_clickable(url, text):
                return f'<a target="_blank" href="{url}">{text}</a>'
        df = df[["Name","Text","Link","Drawer_No","Page_drawer"]]
        df["Link"] = df["Link"].apply(make_clickable, args = ('Link',))
        df.rename(columns={"Drawer_No":"Drawer","Page_drawer":"Page"},inplace=True)
        return df
    



    selected_identity,explore_topic = dataset_selector()

    second_exp = st.beta_expander("Explore Selected Colletions",True)
    with second_exp:
        container2 = st.beta_container()
        with container2:
            second_container_displayed_df =generate_data(selected_identity,explore_topic)
            second_container_displayed_df = short_link(second_container_displayed_df)
            st.write(second_container_displayed_df.to_html(escape = False), unsafe_allow_html = True)
            # st.table(second_container_displayed_df)

            # st.table(second_container_displayed_df)
            # st.table(second_container_displayed_df[["Name","Text","Link"]])