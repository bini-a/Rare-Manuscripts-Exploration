import streamlit as st
import pandas as pd
import numpy as np
import neattext as nt 
from neattext.functions import clean_text
from wordcloud import WordCloud, ImageColorGenerator
import matplotlib.pyplot as plt
import re
import pickle 


df = pd.read_csv("main_data.csv")
# select only collection heads, with available year
df_year = df[~df.Collection_Head.isnull()]
df_year = df_year[~df_year.Year.isnull()]
df_year = df_year[~df_year.Start.isnull()]
#convert to numeric
df_year.Start = pd.to_numeric(df_year.Start,downcast='integer')  
df_year.End = pd.to_numeric(df_year.End,downcast='integer')
df_year['End'] = df_year['End'].astype(float).astype('Int64')

# select appropriate dates
df_year = df_year[df_year.Start<df_year.End]
df_year = df_year[(df_year.Start>1700) & (df_year.End>1700)]
df_year["Country"] = df_year.Country.fillna("Unknown")
df_year["Continent"] = df_year.Continent.fillna("Unknown")

# create continent to country dictionary
continent_list = df_year.Continent.unique()
continent_country = {}
for i in continent_list:
    continent_country[i] = set()
for ind,row in df_year.iterrows():
    continent_country[row.Continent].add(row.Country)
# Create Drawer to page number dictionary

x =(list(zip(df_year.Drawer_No,df_year.Page_drawer)))
drawer_dict = {}
for i in df_year.Drawer_No.unique():
    drawer_dict[i]=list()
for a,b in x:
    drawer_dict[a].append(b)
 
 
    
my_stopword =["haven't", 'it', 'its', 'further', 'can', 'did', "she's", 'such', 've', 'that', 'at', 'where', 'all', 'they', 'don', 'hasn', 're', 'm', 'ours', 'am', 'this', 'needn', 'while', 'again', 'as', 'from', 'once', 'any', 'aren', 'wasn', "shouldn't", 'other', 'be', 'below', 'then', 'very', "couldn't", 'having', 'if', 'herself', 'through', "you'd", 'who', 'had', 'haven', 'after', 'yours', 'whom', 'hers', 'more', "isn't", 'her', "aren't", "don't", "hadn't", 'how', 'his', 'why', 'to', "you've", 'same', 'she', 'themselves', 'an', 'their', 'because', "didn't", 'll', 'd', 'than', "you'll", "you're", 'ain', 'when', 'couldn', 'been', 'there', 'by', 'myself', 'during', 'about', 'both', 'i', 'with', 'just', 'being', 'the', 'ourselves', 'so', 'have', 'we', "shan't", 'me', 'those', 's', 'wouldn', "needn't", 'what', 'itself', "that'll", 'on', 'you', 'between', 'most', 'yourselves', 'off', 'himself', "it's", 'our', 'is', 'no', 'under', "won't", 'over', 'too', 'hadn', 'of', 'were', 'was', 'few', "wouldn't", "mightn't", 'now', "hasn't", 'does', 'doing', 'each', 'own', "should've", 'he', 'above', 'will', "wasn't", 'mightn', 'in', 'not', "mustn't", 'which', 'only', 'your', 'him', 'these', 'against', 'until', 'isn', "doesn't", 't', 'into', 'for', 'mustn', 'some', 'my', 'o', 'doesn', 'ma', 'but', 'has', 'before', 'down', 'theirs', 'out', 'nor', 'or', 'shan', 'up', 'didn', 'a', 'weren', "weren't", 'do', 'them', 'are', 'here', 'and', 'y', 'shouldn', 'yourself', 'won', 'should']
my_stopword.extend(['i', 'me', 'my', 'myself', 'we', 'our', 'ours', "itemse",'ourselves', 'you', "you're", "you've", "you'll", "you'd", 'your', 'yours', 'yourself', 'yourselves', 'he', 'him', 'his', 'himself', 'she', "she's", 'her', 'hers', 'herself', 'it', "it's", 'its', 'itself', 'they', 'them', 'their', 'theirs', 'themselves', 'what', 'which', 'who', 'whom', 'this',
'that', "that'll", 'these', 'those', 'am', 'is', 'are', 'was', 'were', 'be', 'been', 'being', 'have', 'has', 'had', 'having', 'do', 'does', 'did', 'doing', 'a', 'an', 'the', 'and', 'but', 'if', 'or', 'because', 'as', 'until', 'while', 'of', 'at', 'by', 'for', 'with', 'about', 'against', 'between', 'into', 'through', 'during', 'before', 
'after', 'above', 'below', 'to', 'from', 'up', 'down', 'in', 'out', 'on', 'off', 'over', 'under', 'again', 'further', 'then', 'once', 'here', 'there', 'when', 'where', 'why', 'how', 'all', 'any', 'both', 'each', 'few', 'more', 'most', 'other', 'some', 'such', 'no', 'nor', 'not', 'only', 'own', 'same', 'so', 'than', 'too', 'very', 's', 't', 'can', 'will', 'just', 'don', "don't", 'should', "should've", 'now', 'd', 'll', 'm', 'o', 're', 've', 'y', 'ain', 'aren', "aren't", 'couldn', "couldn't", 'didn', "didn't", 'doesn', "doesn't", 'hadn', "hadn't", 'hasn', "hasn't", 'haven', "haven't", 'isn', "isn't", 'ma', 'mightn', "mightn't", 'mustn', "mustn't", 'needn', "needn't", 'shan', "shan't", 'shouldn', "shouldn't", 'wasn', "wasn't", 'weren', "weren't", 'won', "won't", 'wouldn', "wouldn't", 'papers', 'letters', 'items', 'letter', 'collection', 'family', 'co', 'also', 'added', 'see', 'sketch', 'one', 'two', 'ten', 'pp', 'book', 'section', 'ndhyme', 'many', 'item', 'next', 'dec', 'jan', 'feb', 'mar', 'apr', 'may', 'jun', 'jul', 'aug', 'sep', 'oct', 'nov', 'december', 'january', 'febraury', 'march', 'april', 'may', 'june', 'july', 'august', 'september', 'october', 'november', 'vol', 'volume', 'addition', 'sept', 'include', 'included',
'crd', 'eee', 'card', 'new', 'contain', 'boards', 'cm', 'tion', 'including', 'company', 'vols', 'ing', 'three', 'first', 'papers', 'letters', 'paper', 'letter', 'collection', 'collections', 'items', 'record', 'records', 'contains', 'list', 'letter', 'collection', 'family', 'co', 'also', 'added', 'see', 'sketch', 'one', 'two', 'ten', 'pp', 'book', 'section', 'ndhyme', 'many', 'item', 'next', 'december', 'january', 'febraury', 'march', 'april', 'may', 'report', 'mention', 'concerning', 'several', 
'guide', 'made', 'june', 'july', 'august', 'september', 'october', 'november', 'vol', 'volume', 'addition', 'sept', 'please', 'ask'])  
def clean(full):
        # remove punctuation
    full_no_punc = re.sub(r"\.|!", "",full)
    
    # Select only those longer than 1
    full_no_punc = " ".join([i for i in full_no_punc.split() if len(i)>1])

    # Tokenize
    text_tokens = nt.TextFrame(full_no_punc).word_tokens()

    # Change to lower case and select only alphanumeric
    pre_process = [i.lower() for i in text_tokens if i.isalpha()]

    # Remove Stop Words,# remove_single_characters
    token_no_stopword = [word for word in pre_process if word not in my_stopword]

    filtered_sentence = (" ").join(token_no_stopword)
    return filtered_sentence
df_grouped = df_year.groupby(["Start"])["Text"].apply(" ".join).reset_index()
df_grouped["Clean"] = df_grouped["Text"].apply(clean)



## Implementation detail for the following data can be found under the project repository
collection_dict = {}
# Dictionaries with indices for history searching
collection_dict["president_indices"] = {"York": [7072, 14590, 50164, 50170], "Craven": [2004, 2005, 9541, 10235, 11146, 11155, 11156, 11161, 11167, 11168, 11169, 11170, 11171, 11172, 11173, 11174, 11175, 11176, 11177, 11178, 11179, 11180, 11181, 11182, 11183, 11197, 11200, 14590, 15131, 19231, 20678, 20732, 21211, 25196, 27216, 48485],
                        "Gannaway": [6266, 6267, 6269, 16522, 41864], "Wood": [13320, 30929, 30984, 49501, 49528],
                        "Crowell": [127, 11387, 19234, 32886, 46573], "Kilgo": [158, 6815, 21326, 25715, 31143, 31930, 42066, 42069, 45697, 45808],
                        "Few": [4293, 4295, 5490, 5535, 6660, 7338, 7356, 13399, 13678, 13680, 14742, 15288, 15290, 15291, 15292, 15293, 15294, 15726, 17493, 17627, 17628, 17632, 18218, 21323, 26808, 28326, 32409, 34437, 34637, 35247, 42069, 46891, 47138, 47141],
                        "Flowers": [10743, 15710, 16296, 19004, 20519, 22959, 26399, 27309, 28173, 30657, 34052, 42059, 42065, 44500, 45697],
                        "Edens": [], "Hart": [14123], "Knight": [5490, 25741, 30171, 47829],
                        "Sanford": [5490, 9533, 9541, 9554, 19873, 19875, 22266, 39311, 39312, 39313, 39314, 39363, 39364, 39365, 42007, 44948, 45317],
                        "Brodie": [], "Keohane": [], "Brodhead": [2619, 34442, 35593]}
collection_dict["name_indices"] = {'brown': [], 'union': [31358, 50170], 'normal': [410, 2004, 4821, 5148, 5149, 6904, 7031, 9828, 15130, 15131, 15133, 20074, 20075, 25093, 25094, 25195, 44683, 47523, 47901, 48481, 48488], 'trinity': [127, 158, 932, 949, 1950, 2004, 2726, 4207, 4294, 4855, 4859, 5861, 5864, 5955, 6085, 6659, 6815, 6917, 6918, 6921, 7684, 7685, 7687, 7688, 7698, 7700, 8356, 9180, 9645, 10235, 10741, 10906, 10920, 11155, 11156, 11158, 11161, 11164, 11197, 11199, 11200, 11731, 11822, 12078, 13261, 13302, 13303, 13317, 13671, 13674, 14005, 15133, 16211, 17237, 17238, 17239, 17306, 17967, 19231, 19295, 19298, 19384, 20729, 20731, 21237, 21765, 22038, 22129, 22147, 22150, 22158, 23045, 24107, 24513, 24523, 24837, 25004, 25621, 25748, 27216, 27397, 27816, 27836, 28173, 28657, 28659, 28828, 30321, 30375, 30376, 30480, 30706, 30943, 30945, 30947, 30951, 31012, 31013, 31015, 31016, 31017, 31018, 31019, 31247, 31977, 32804, 32886, 34437, 34637, 34654, 35029, 35460, 37321, 37405, 37500, 37748, 37801, 38323, 38324, 39272, 39480, 39481, 39702, 40312, 40454, 40468, 40616, 40644, 40703, 41457, 41590, 41594, 41642, 41914, 42030, 42061, 42065, 42066, 42069, 42408, 42531, 42532, 42919, 42927, 43242, 43348, 43352, 43354, 43616, 43619, 44460, 44474, 44507, 44696, 45276, 45662, 45663, 45693, 45696, 45697, 45808, 46887, 47503, 47523, 49746, 49750, 49751, 50170, 50219], 'duke': [59, 60, 258, 415, 509, 515, 568, 570, 571, 572, 575, 577, 596, 749, 751, 752, 800, 878, 881, 888, 1084, 1085, 1408, 1432, 1594, 1619, 1941, 1950, 2095, 2168, 2178, 2388, 2820, 2829, 3592, 3885, 3912, 4139, 4143, 4273, 4294, 4463, 4465, 4466, 4467, 4471, 4472, 4504, 4664, 4665, 4860, 5148, 5149, 5231, 5488, 5489, 5610, 5730, 6085, 6086, 6090, 6106, 6116, 6122, 6185, 6186, 6236, 6265, 6434, 6551, 6565, 6630, 6773, 6777, 6844, 6986, 6990, 7021, 7337, 7484, 7683, 7688, 7701, 7974, 8023, 8085, 8090, 8093, 8185, 8191, 8251, 8356, 9038, 9179, 9180, 9260, 9273, 9404, 9405, 9407, 9410, 9412, 9414, 9417, 9419, 9420, 9645, 9663, 10329, 10354, 10386, 10504, 10662, 10743, 10752, 10753, 11037, 11045, 11168, 11175, 11197, 11337, 11735, 11737, 11823, 12145, 12152, 12533, 12561, 12679, 13053, 13141, 13302, 13318, 13655, 13669, 13692, 13693, 13694, 13695, 13696, 13741, 13743, 13745, 13746, 13747, 13750, 13751, 13752, 13753, 13754, 13755, 13756, 13757, 13758, 13759, 13760, 13761, 13762, 13763, 13764, 13765, 13766, 13767, 13768, 13769, 13770, 13771, 13772, 13773, 13774, 13775, 13776,
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                13777, 13778, 13779, 13780, 13781, 13782, 13783, 13793, 13795, 13796, 13797, 13798, 13799, 13800, 13801, 13806, 13807, 13808, 13809, 14399, 14484, 14512, 14516, 14517, 14585, 14623, 14861, 14979, 14983, 15294, 15511, 15697, 15751, 15752, 15927, 15939, 16184, 16278, 16529, 16542, 16556, 16557, 16797, 16842, 16922, 17179, 17472, 17493, 17494, 17497, 17498, 17754, 17756, 18432, 18666, 18712, 18713, 18952, 19185, 19309, 19311, 19334, 19384, 19444, 19616, 19647, 19648, 19650, 19651, 19652, 19653, 19658, 19660, 19662, 19666, 19771, 19865, 19909, 19912, 19920, 20156, 20210, 20212, 20214, 20318, 20523, 20542, 20549, 20823, 21005, 21396, 21508, 21566, 21616, 21723, 21815, 21954, 22050, 22265, 22266, 22267, 22272, 22285, 22594, 22595, 22597, 22618, 22772, 22868, 22869, 22871, 22893, 22895, 22905, 22921, 22922, 22923, 22926, 22943, 23288, 23343, 23775, 23909, 24166, 24237, 24525, 24619, 24838, 25049, 25074, 25251, 25262, 25263, 25264, 25665, 26306, 26307, 26393, 26398, 26399, 26603, 26801, 26854, 27338, 27340, 27457, 27486, 27719, 27720, 27790, 27802, 27889, 28247, 28561, 28601, 28658, 28718, 28828, 29203, 29456, 29573, 29623, 30375, 30376, 30650, 30666, 30677, 31230, 31322, 31509, 31813, 31892, 31899, 32183, 32297, 32343, 32851, 32877, 32971, 33042, 33092, 33642, 33672, 33917, 33922, 34078, 34080, 34136, 34437, 34537, 34539, 34654, 34850, 34882, 35029, 35030, 35031, 35234, 35237, 35251, 35367, 35373, 35418, 35620, 35990, 36033, 36215, 36299, 36493, 36495, 36496, 36542, 36652, 36711, 36804, 36868, 36869, 37052, 37205, 37214, 37221, 37260, 37261, 37263, 37405, 37612, 37613, 37656, 37657, 37801, 37847, 37849, 38056, 38063, 38064, 38071, 38235, 38401, 38412, 38679, 38866, 39017, 39135, 39255, 39258, 39271, 39294, 39295, 39297, 39311, 39313, 39314, 39673, 39675, 39679, 39680, 39681, 39744, 39745, 39747, 39748, 40073, 40076, 40077, 40078, 40080, 40082, 40083, 40235, 40319, 40337, 40338, 40616, 40703, 40878, 40952, 40978, 41173, 41174, 41568, 41644, 41703, 41736, 41775, 42007, 42051, 42069, 42377, 42533, 42780, 42991, 42994, 43032, 43238, 43242, 43243, 43244, 43247, 43338, 43348, 43352, 43369, 43370, 43417, 43598, 43599, 43616, 43760, 43762, 43763, 43996, 44012, 44200, 44245, 44447, 44459, 44513, 44535, 44812, 44857, 44859, 45317, 45318, 45704, 45710, 45866, 46093, 46469, 46470, 46473, 46685, 47102, 47152, 47173, 47272, 47601, 47703, 47864, 47880, 47979, 48169, 48439, 48644, 48709, 49487, 49585, 49586, 49592, 49716, 50170]}
collection_dict["buildings"] = {'Alspaugh': [644], 'Baldwin': [2093, 2094, 20279, 21958, 21987, 21988, 33105, 33124, 33125], 'Bassett': [2902, 2903], 'Blackwell': [4524, 4525, 4529, 4530, 4532, 4534, 4537, 4549, 4550, 4551, 4552, 4553, 4554, 4555, 4556, 4557, 4558, 4559, 4560, 4561, 4562, 4563, 4564, 4565, 4566, 4567, 4568, 4569, 4570, 4571, 4572, 4573, 4574, 4575, 4577, 4578], 'Brodie': [5869], 'Brown': [672, 5635, 6019, 6023, 6045, 6046, 6047, 6049, 6059, 6060, 6062, 6065, 6068, 6069, 6073, 6076, 6077, 6079, 6081, 6082, 6083, 6084, 6123, 6125, 6127, 6134, 6136, 6137, 6138, 6140, 6142, 6145, 6146, 6148, 6150, 6153, 6156, 6157, 6158, 6159, 6160, 6161, 6163, 6164, 6165, 6166, 6167, 6168, 6169, 6170, 6171, 6172, 6173, 6174, 6175, 6176, 6184, 6188, 6192, 6195, 6196, 6198, 6201, 6202, 6206, 6215, 6223, 6224, 6225, 6226, 6240, 6241, 9600, 9605], 'Crowell': [11387], 'Giles': [17234, 17236, 17242, 17243, 43415, 43419, 47180], 'Lilly': [10994, 27597], 'Biddle': [4287, 4291, 4292, 4293, 4296, 4299, 4300, 4314, 4315, 4316, 4317, 4318, 4319, 4320, 4321, 4323, 4324, 38118, 40075], 'Pegram': [35032, 35033, 35034, 35035, 35036], 'Southgate': [42029, 42030, 42067, 42068], 'White': [27817, 48046, 48048, 48050, 48051, 48053, 48054, 48056, 48058, 48059, 48060, 48061, 48062, 48063, 48064, 48065, 48067, 48077, 48086, 48090, 48091, 48092, 48094, 48100,
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     48101, 48110, 48112, 48114, 48118, 48119, 48120, 48122, 48125, 48126, 48129, 48131, 48133, 48134, 48141, 48143, 48144, 48146], 'Wilson': [7645, 15252, 27146, 33430, 35342, 48955, 48958, 48960, 48961, 48964, 48967, 48968, 48969, 48970, 48971, 48980, 48986, 48987, 48990, 48996, 48998, 49000, 49004, 49007, 49008, 49009, 49019, 49021, 49024, 49028, 49030, 49031, 49034, 49035, 49036, 49038, 49040, 49042, 49043, 49045, 49047, 49049, 49052, 49053, 49056, 49059, 49062, 49064, 49066], 'Allen': [486, 487, 499, 503, 505, 507, 508, 509, 515, 518, 519, 520, 521, 522, 523, 524, 525, 529, 530, 533, 535, 538, 540, 544, 547, 548, 549, 550, 552, 553, 554, 563, 566, 14979, 15511, 17472, 22453, 34964, 35032, 35033, 35034, 35035, 35292, 35293, 37048, 49468], 'Flowers': [15700, 15708, 15710, 15711], 'Gray': [18368, 18369, 18370, 18372, 18375, 18381, 18383, 18386, 18388, 18390, 18391, 18392, 23022], 'Hart': [20569, 20574, 20575, 20577, 20579, 20580, 20582, 20584, 20588, 20593], 'Perkins': [35223, 35226, 35228, 35241, 35243, 35246], 'Rubenstein': [], 'Sanford': [37109, 39311, 39349, 39350, 39355, 39357, 39359, 39360, 39363, 39367], 'Wilkinson': [48566, 48572, 48574, 48575, 48577], 'Craven': [11142, 11146, 11147, 11153, 11154, 11167, 11184, 11192, 11193, 14234], 'Edens': [14394], 'Few': [15285, 15288, 15290, 15293], 'Kilgo': [25715]}
# charleston earthquake
collection_dict["charleston"] = [1295, 11346, 12237, 12465, 12498, 12499, 12820, 16096, 21313,
                24542, 35513, 36175, 37469]
# wilmington race riot
collection_dict["wilmington"] = [9038, 9039, 9040, 9041, 9044, 11353, 11354]
collection_dict["civil_war"] = [14, 15, 113, 181, 200, 285, 287, 297, 351, 354, 376, 488, 537, 651, 675, 840, 841, 847, 862, 927, 941, 959, 961, 971, 972, 977, 995, 1015, 1029, 1033, 1079, 1103, 1294, 1380, 1412, 1413, 1420, 1426, 1453, 1454, 1456, 1462, 1464, 1483, 1487, 1499, 1524, 1536, 1537, 1554, 1561, 1568, 1728, 1753, 1786, 1795, 1796, 1800, 1813, 1855, 1857, 1901, 1926, 1928, 1930, 1931, 2021, 2027, 2318, 2438, 2440, 2441, 2527, 2564, 2583, 2629, 2745, 2750, 2770, 2794, 2797, 2828, 2830, 2834, 2857, 2858, 2875, 2876, 2879, 2895, 2925, 2931, 2932, 2975, 3001, 3007, 3020, 3025, 3032, 3048, 3085, 3086, 3088, 3092, 3097, 3115, 3117, 3123, 3179, 3205, 3211, 3225, 3241, 3265, 3270, 3359, 3371, 3379, 3382, 3384, 3394, 3419, 3421, 3441, 3463, 3475, 3536, 3537, 3572, 3697, 3699, 3711, 3714, 3728, 3731, 3766, 3767, 3792, 3810, 3816, 3817, 3824, 3859, 3884, 3890, 3899, 3902, 3903, 3940, 3949, 3954, 4051, 4096, 4098, 4099, 4103, 4104, 4130, 4159, 4187, 4310, 4311, 4339, 4340, 4378, 4409, 4413, 4520, 4521, 4541, 4666, 4695, 4698, 4705, 4721, 4775, 4777, 4849, 4865, 4880, 4881, 4948, 4976, 4987, 5005, 5055, 5062, 5063, 5078, 5110, 5150, 5174, 5190, 5207, 5209, 5230, 5304, 5389, 5401, 5404, 5410, 5438, 5441, 5455, 5462, 5465, 5468, 5488, 5490, 5495, 5497, 5504, 5513, 5519, 5548, 5569, 5585, 5600, 5607, 5634, 5695, 5718, 5737, 5751, 5753, 5754, 5791, 5847, 5850, 5861, 5862, 5864, 5885, 5911, 5934, 5939, 5945, 5966, 6029, 6059, 6068, 6130, 6189, 6191, 6195, 6225, 6250, 6251, 6252, 6256, 6259, 6268, 6277, 6323, 6332, 6350, 6351, 6352, 6362, 6365, 6385, 6387, 6509, 6584, 6592, 6607, 6638, 6639, 6649, 6752, 6759, 6774, 6823, 6866, 6872, 6967, 6972, 7028, 7034, 7055, 7056, 7071, 7074, 7139, 7155, 7157, 7197, 7205, 7206, 7211, 7220, 7340, 7366, 7393, 7395, 7416, 7419, 7501, 7507, 7508, 7509, 7532, 7537, 7538, 7540, 7556, 7617, 7647, 7681, 7697, 7699, 7703, 7719, 7721, 7735, 7766, 7779, 7804, 7805, 7870, 7877, 7964, 8001, 8003, 8005, 8014, 8032, 8100, 8102, 8126, 8135, 8160, 8163, 8191, 8192, 8228, 8229, 8293, 8295, 8448, 8453, 8504, 8572, 8596, 8608, 8639, 8642, 8684, 8685, 8686, 8687, 8688, 8689, 8711, 8725, 8856, 8857, 8870, 8919, 8941, 8994, 9007, 9008, 9057, 9059, 9170, 9221, 9238, 9248, 9250, 9259, 9260, 9265, 9277, 9321, 9326, 9375, 9383, 9384, 9386, 9506, 9545, 9564, 9567, 9568, 9569, 9577, 9578, 9579, 9580, 9635, 9699, 9713, 9820, 9825, 9827, 9829, 10007, 10035, 10073, 10185, 10208, 10209, 10245, 10263, 10264, 10265, 10266, 10267, 10270, 10495, 10498, 10499, 10585, 10586, 10646, 10653, 10669, 10679, 10680, 10695, 10697, 10707, 10708, 10709, 10714, 10728, 10732, 10734, 10760, 10789, 10795, 10796, 10797, 10814, 10823, 10826, 10837, 10889, 10897, 10900, 10903, 10920, 10922, 10923, 10940, 10950, 11008, 11058, 11078, 11079, 11082, 11120, 11121, 11122, 11194, 11223, 11234, 11294, 11299, 11306, 11344, 11345, 11348, 11350, 11372, 11373, 11400, 11418, 11442, 11469, 11525, 11531, 11543, 11576, 11606, 11609, 11677, 11678, 11685, 11700, 11715, 11718, 11728, 11745, 11754, 11755, 11765, 11767, 11768, 11787, 11794, 11796, 11803, 11918, 11978, 11992, 12013, 12014, 12017, 12024, 12044, 12045, 12057, 12069, 12097, 12101, 12106, 12139, 12165, 12167, 12168, 12187, 12225, 12302, 12450, 12475, 12502, 12602, 12603, 12604, 12619, 12629, 12654, 12699, 12706, 12708, 12712, 12749, 12750, 12763, 12766, 12806, 12808, 12817, 12867, 12868, 12882, 12909, 12945, 12974, 12977, 13019, 13020, 13043, 13057, 13083, 13087, 13094, 13117, 13143, 13191, 13210, 13211, 13216, 13277, 13287, 13289, 13292, 13294, 13303, 13304, 13314, 13333, 13357, 13391, 13402, 13422, 13426, 13429, 13495, 13529, 13530, 13550, 13584, 13716, 13722, 13812, 13956, 13959, 13965, 13988, 13991, 14188, 14199, 14212, 14222, 14270, 14382, 14433, 14483, 14493, 14508, 14509, 14528, 14539, 14541, 14561, 14564, 14589, 14591, 14606, 14611, 14615, 14618, 14630, 14638, 14649, 14663, 14664, 14665, 14666, 14728, 14729, 14739, 14766, 14767, 14806, 14856, 14963, 14969, 14970, 14974, 14976, 14982, 15075, 15078, 15082, 15110, 15120, 15122, 15189, 15222, 15241, 15301, 15317, 15429, 15435, 15445, 15479, 15480, 15516, 15518, 15536, 15537, 15544, 15547, 15551, 15622, 15658, 15670, 15675, 15678, 15739, 15740, 15742, 15743, 15783, 15809, 15812, 15816, 15820, 15821, 15822, 15840, 15855, 15864, 15894, 15895, 15898, 15900, 15911, 15925, 15926, 15943, 16000, 16010, 16067, 16092, 16093, 16138, 16140, 16228, 16229, 16242, 16289, 16297, 16307, 16308, 16309, 16314, 16321, 16325, 16342, 16383, 16385, 16388, 16457, 16475, 16476, 16477, 16482, 16516, 16517, 16538, 16565, 16569, 16574, 16600, 16606, 16607, 16626, 16627, 16652, 16691, 16718, 16750, 16754, 16799, 16807, 16808, 16809, 16810, 16818, 16819, 16823, 16824, 16845, 16856, 16865, 17043, 17081, 17148, 17149, 17260, 17292, 17401, 17403, 17437, 17566, 17613, 17618, 17628, 17666, 17671, 17673, 17742, 17884, 17886, 17892, 17896, 17904, 17906, 17908, 17924, 17931, 17935, 17937, 17942, 17943, 17944, 17945, 17948, 17953, 17955, 18055, 18056, 18147, 18151, 18154, 18199, 18215, 18217, 18218, 18222, 18384, 18570, 18672, 18677, 18689, 18705, 18964, 18971, 18972, 19027, 19029, 19168, 19169, 19190, 19191, 19244, 19248, 19264, 19266, 19271, 19284, 19286, 19302, 19318, 19345, 19365, 19394, 19395, 19405, 19408, 19447, 19448, 19512, 19527, 19587, 19615, 19637, 19710, 19715, 19739, 19798, 19840, 19844, 19936, 19947, 19967, 19974, 19991, 20006, 20022, 20026, 20079, 20097, 20188, 20218, 20223, 20281, 20282, 20290, 20320, 20354, 20366, 20371, 20430, 20453, 20479, 20500, 20504, 20561, 20571, 20597, 20600, 20614, 20662, 20665, 20671, 20732, 20735, 20736, 20737, 20779, 20800, 20803, 20869, 20975, 20985, 21000, 21031, 21046, 21050, 21170, 21246, 21250, 21251, 21302, 21306, 21393, 21415, 21416, 21420, 21472, 21494, 21558, 21561, 21592, 21594, 21597, 21744, 21782, 21823, 21865, 21866, 21895, 21898, 21899, 21908, 21995, 22067, 22134, 22136, 22158, 22202, 22257, 22258, 22273, 22326, 22420, 22421, 22428, 22430, 22443, 22487, 22488, 22493, 22605, 22630, 22651, 22669, 22671, 22691, 22778, 22785, 22795, 22796, 22827, 22835, 22840, 22845, 22856, 22857, 22866, 22949, 22957, 23093, 23112, 23176, 23243, 23248, 23274, 23280, 23439, 23494, 23560, 23601, 23605, 23813, 23893, 23894, 23930, 23967, 23969, 23986, 23992, 23996, 23997, 24092, 24120, 24132, 24163, 24166, 24170, 24320, 24342, 24350, 24361, 24373, 24392, 24453, 24454, 24470, 24546, 24599, 24640, 24717, 24718, 24743, 24819, 24820, 24821, 24823, 24829, 24870, 24873, 24905, 24925, 24930, 24981, 24982, 24995, 25002, 25003, 25017, 25097, 25098, 25126, 25163, 25210, 25230, 25277, 25287, 25308, 25336, 25338, 25339, 25360, 25362, 25363, 25376, 25378, 25379, 25393, 25394, 25395, 25396, 25435, 25438, 25441, 25448, 25454, 25477, 25501, 25505, 25519, 25542, 25561, 25569, 25609, 25620, 25636, 25669, 25670, 25673, 25712, 25727, 25728, 25806, 25812, 25876, 26186, 26191, 26201, 26213, 26220, 26244, 26270, 26272, 26426, 26497, 26586, 26588, 26639, 26677, 26678, 26686, 26737, 26738, 26749, 26822, 26833,
                26871, 26885, 26887, 26913, 26977, 26978, 26979, 26980, 26993, 27001, 27019, 27046, 27058, 27125, 27245, 27246, 27247, 27260, 27262, 27365, 27367, 27392, 27427, 27523, 27537, 27562, 27587, 27660, 27661, 27678, 27763, 27789, 27790, 27816, 27834, 27888, 27895, 27956, 28004, 28007, 28011, 28017, 28021, 28053, 28076, 28083, 28086, 28088, 28105, 28116, 28117, 28120, 28129, 28130, 28150, 28226, 28240, 28241, 28305, 28343, 28368, 28390, 28418, 28440, 28485, 28489, 28494, 28509, 28559, 28575, 28576, 28582, 28583, 28592, 28594, 28645, 28657, 28659, 28666, 28668, 28669, 28694, 28759, 28779, 28810, 28817, 28832, 28862, 28908, 28920, 28930, 28942, 28955, 28967, 29009, 29015, 29018, 29031, 29045, 29050, 29084, 29096, 29111, 29112, 29145, 29151, 29162, 29222, 29223, 29225, 29241, 29274, 29329, 29400, 29439, 29446, 29466, 29542, 29601, 29602, 29608, 29613, 29643, 29693, 29782, 29799, 29812, 29818, 29821, 29825, 29827, 29838, 29964, 29982, 30020, 30084, 30196, 30197, 30198, 30199, 30217, 30266, 30290, 30292, 30295, 30360, 30361, 30391, 30398, 30505, 30628, 31197, 31198, 31203, 31253, 31255, 31310, 31312, 31345, 31403, 31417, 31421, 31474, 31539, 31556, 31562, 31566, 31570, 31588, 31597, 31598, 31603, 31613, 31658, 31659, 31686, 31702, 31703, 31708, 31733, 31806, 31807, 31838, 31844, 32072, 32090, 32158, 32187, 32189, 32190, 32204, 32212, 32216, 32247, 32250, 32260, 32285, 32310, 32323, 32326, 32353, 32400, 32404, 32406, 32407, 32408, 32409, 32418, 32419, 32425, 32429, 32433, 32434, 32494, 32504, 32505, 32508, 32512, 32515, 32517, 32525, 32562, 32564, 32569, 32573, 32588, 32607, 32615, 32616, 32637, 32661, 32678, 32686, 32690, 32737, 32738, 32748, 32857, 32862, 32883, 32890, 32894, 32897, 32901, 32927, 32992, 32996, 32997, 33007, 33011, 33013, 33034, 33068, 33106, 33109, 33147, 33171, 33230, 33237, 33270, 33273, 33460, 33461, 33492, 33500, 33508, 33516, 33533, 33541, 33549, 33556, 33557, 33619, 33683, 33758, 33760, 33764, 33774, 33784, 33789, 33801, 33868, 33877, 33886, 33895, 33897, 33931, 33934, 33995, 34175, 34192, 34263, 34306, 34311, 34313, 34372, 34398, 34444, 34493, 34497, 34509, 34514, 34531, 34543, 34578, 34593, 34637, 34648, 34652, 34653, 34656, 34657, 34683, 34694, 34724, 34781, 34787, 34789, 34809, 34813, 34819, 34837, 34851, 34852, 34855, 34858, 34965, 34980, 35036, 35046, 35069, 35074, 35075, 35086, 35089, 35115, 35117, 35133, 35144, 35145, 35169, 35176, 35306, 35324, 35348, 35420, 35450, 35505, 35508, 35529, 35542, 35554, 35592, 35601, 35630, 35631, 35661, 35670, 35671, 35672, 35676, 35678, 35694, 35739, 35743, 35773, 35799, 35822, 35832, 35842, 36005, 36076, 36090, 36091, 36128, 36141, 36143, 36144, 36145, 36146, 36147, 36148, 36179, 36180, 36254, 36278, 36310, 36344, 36346, 36389, 36396, 36401, 36603, 36646, 36647, 36659, 36850, 36925, 36997, 37004, 37035, 37044, 37045, 37060, 37101, 37103, 37134, 37163, 37218, 37219, 37220, 37336, 37346, 37348, 37385, 37417, 37438, 37475, 37513, 37530, 37532, 37589, 37590, 37617, 37647, 37680, 37682, 37706, 37728, 37742, 37745, 37771, 37773, 37788, 37937, 37952, 37955, 37971, 37996, 38007, 38010, 38109, 38152, 38154, 38206, 38239, 38241, 38252, 38253, 38267, 38285, 38291, 38309, 38336, 38348, 38370, 38378, 38434, 38438, 38476, 38477, 38488, 38531, 38536, 38538, 38564, 38631, 38692, 38745, 38749, 38758, 38788, 38790, 38797, 38799, 38803, 38902, 38903, 38909, 38911, 38987, 38988, 38990, 39002, 39014, 39038, 39069, 39082, 39183, 39205, 39206, 39236, 39304, 39357, 39358, 39394, 39418, 39422, 39423, 39465, 39535, 39552, 39565, 39592, 39593, 39609, 39648, 39650, 39670, 39706, 39720, 39723, 39740, 39752, 39772, 39806, 39818, 39901, 39978, 40050, 40058, 40100, 40101, 40128, 40129, 40131, 40136, 40138, 40197, 40202, 40208, 40215, 40237, 40238, 40255, 40305, 40333, 40387, 40403, 40414, 40420, 40424, 40428, 40429, 40433, 40450, 40461, 40492, 40493, 40495, 40501, 40502, 40503, 40505, 40541, 40589, 40590, 40662, 40667, 40781, 40787, 40796, 40843, 40844, 40847, 40851, 40897, 40917, 40921, 40958, 40994, 40996, 40999, 41056, 41075, 41078, 41088, 41108, 41127, 41146, 41171, 41187, 41195, 41198, 41212, 41226, 41228, 41235, 41239, 41240, 41302, 41306, 41307, 41309, 41384, 41386, 41397, 41399, 41403, 41405, 41414, 41492, 41494, 41500, 41502, 41519, 41523, 41528, 41551, 41554, 41641, 41761, 41765, 41802, 41857, 41858, 41859, 41868, 41880, 41892, 41995, 42045, 42055, 42057, 42071, 42077, 42078, 42080, 42115, 42163, 42170, 42172, 42189, 42193, 42211, 42276, 42286, 42295, 42350, 42368, 42380, 42385, 42414, 42464, 42465, 42494, 42502, 42503, 42511, 42596, 42597, 42598, 42617, 42618, 42620, 42622, 42627, 42629, 42821, 42829, 42831, 42841, 42842, 42854, 42875, 42968, 42982, 43033, 43034, 43037, 43038, 43040, 43043, 43052, 43092, 43098, 43129, 43143, 43165, 43276, 43278, 43360, 43364, 43399, 43463, 43486, 43499, 43501, 43515, 43517, 43519, 43546, 43553, 43558, 43562, 43596, 43605, 43617, 43636, 43637, 43642, 43658, 43678, 43719, 43749, 43754, 43796, 43811, 43849, 43852, 43869, 43880, 43888, 43906, 43911, 43923, 43930, 43942, 43958, 44017, 44020, 44023, 44037, 44056, 44057, 44059, 44101, 44162, 44177, 44180, 44181, 44204, 44219, 44223, 44226, 44231, 44232, 44249, 44326, 44328, 44350, 44376, 44394, 44407, 44423, 44435, 44517, 44622, 44654, 44687, 44696, 44697, 44722, 44750, 44921, 44923, 44927, 44938, 44989, 44991, 45018, 45045, 45065, 45232, 45244, 45324, 45342, 45343, 45347, 45350, 45362, 45397, 45398, 45399, 45414, 45578, 45650, 45652, 45700, 45702, 45765, 45766, 45767, 45785, 45817, 45837, 45840, 45841, 45904, 45933, 45934, 45949, 45950, 45954, 45955, 45961, 45962, 45989, 46048, 46049, 46052, 46061, 46072, 46360, 46403, 46408, 46431, 46432, 46433, 46436, 46481, 46512, 46514, 46634, 46639, 46648, 46669, 46679, 46693, 46694, 46705, 46715, 46737, 46835, 46878, 46899, 46939, 46962, 46966, 46969, 46985, 46988, 46990, 47015, 47023, 47024, 47043, 47057, 47060, 47078, 47134, 47176, 47200, 47215, 47217, 47218, 47219, 47226, 47286, 47289, 47292, 47293, 47310, 47341, 47392, 47393, 47443, 47497, 47501, 47599, 47604, 47606, 47650, 47662, 47663, 47680, 47737, 47756, 47758, 47824, 47840, 47841, 47888, 47889, 47890, 47898, 47900, 47944, 47953, 47954, 47970, 47977, 48011, 48012, 48013, 48024, 48027, 48032, 48033, 48048, 48126, 48135, 48145, 48156, 48157, 48166, 48185, 48193, 48196, 48223, 48229, 48239, 48310, 48314, 48318, 48319, 48398, 48402, 48409, 48493, 48494, 48501, 48510, 48517, 48521, 48522, 48525, 48528, 48538, 48539, 48541, 48558, 48563, 48599, 48607, 48621, 48624, 48626, 48628, 48631, 48693, 48765, 48824, 48829, 48891, 49032, 49045, 49046, 49070, 49071, 49127, 49154, 49160, 49163, 49206, 49286, 49327, 49334, 49362, 49364, 49365, 49407, 49532, 49534, 49566, 49567, 49583, 49607, 49609, 49625, 49629, 49638, 49639, 49643, 49652, 49659, 49666, 49715, 49716, 49723, 49742, 49761, 49785, 49791, 49806, 49810, 49811, 49812, 49813, 50010, 50014, 50029, 50060, 50085, 50110, 50127, 50138, 50139, 50148, 50159, 50223, 50295, 50330, 50342]


# save 
df_year.to_csv("data_year_avail.csv", index=False)
df_grouped.to_csv("df_clean_grouped.csv", index=False)

with open('continent_country.pkl', 'wb') as f:
    pickle.dump(continent_country, f)
with open('drawer_dict.pkl', 'wb') as f:
    pickle.dump(drawer_dict, f)         
with open('collection_dict.pkl', 'wb') as f:
    pickle.dump(collection_dict, f)    